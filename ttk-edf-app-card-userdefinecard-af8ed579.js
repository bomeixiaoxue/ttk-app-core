webpackJsonp([53,60],{"402":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function config(options){options&&(0,_extends3["default"])(_options,options)}Object.defineProperty(exports,"__esModule",{"value":!0});var _extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_webapi=__webpack_require__(1646),_webapi2=_interopRequireDefault(_webapi),_options={"webapi":_webapi2["default"]};config.current=_options,exports["default"]=config,module.exports=exports["default"]},"680":function(module,exports){"use strict";function getMeta(){return{"name":"root","component":"div","className":"ttk-edf-app-card-userdefinecard","children":[{"name":"archivesName","component":"div","className":"ttk-edf-app-card-userdefinecard-archivesname","_visible":"{{data.archivesName ? true : false}}","children":[{"name":"name","component":"Form.Item","label":"\u81ea\u5b9a\u4e49\u6863\u6848\u540d\u79f0","required":!0,"validateStatus":"{{data.other.error.name?'error':'success'}}","help":"{{data.other.error.name}}","children":{"name":"name","component":"Input","maxlength":"20","value":"{{data.form.name}}","onChange":"{{function(e){$sf('data.form.name',e.target.value);$changeCheck()}}}"}}]},{"name":"ttk-edf-app-card-userdefinecard-archive","component":"div","className":"archives-name","_visible":"{{data.archivesName ? false : true}}","children":[{"name":"codeItem","component":"Form.Item","label":"\u7f16\u7801","required":!0,"validateStatus":"{{data.other.error.code?'error':'success'}}","help":"{{data.other.error.code}}","children":{"name":"code","component":"Input","maxlength":"50","value":"{{data.form.code}}","onChange":"{{function(e){$sf('data.form.code',e.target.value);$changeCheck(1)}}}"}},{"name":"name","component":"Form.Item","label":"\u540d\u79f0","required":!0,"validateStatus":"{{data.other.error.name?'error':'success'}}","help":"{{data.other.error.name}}","children":{"name":"name","component":"Input","maxlength":"20","value":"{{data.form.name}}","onChange":"{{function(e){$sf('data.form.name',e.target.value);$changeCheck()}}}"}},{"name":"remarkItem","component":"Form.Item","label":"\u5907\u6ce8","children":[{"name":"remark","component":"Input.TextArea","maxlength":"200","value":"{{data.form.remark}}","onChange":"{{function(e){$sf('data.form.remark',e.target.value)}}}"}]},{"name":"statusItem","component":"Form.Item","label":"\u505c\u7528","children":[{"name":"isEnable","component":"Checkbox","checked":"{{!data.form.isEnable}}","onChange":"{{function(e){$sf('data.form.isEnable',!e.target.checked)}}}"}]}]}]}}function getInitState(){return{"data":{"archivesName":!1,"form":{"code":"","name":"","isEnable":!0},"other":{"error":{}}}}}Object.defineProperty(exports,"__esModule",{"value":!0}),exports.getMeta=getMeta,exports.getInitState=getInitState},"1643":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function creator(option){var metaAction=new _edfMetaEngine.action(option),voucherAction=_edfComponent.FormDecorator.actionCreator((0,_extends3["default"])({},option,{"metaAction":metaAction})),o=new action((0,_extends3["default"])({},option,{"metaAction":metaAction,"voucherAction":voucherAction})),ret=(0,_extends3["default"])({},metaAction,voucherAction,o);return metaAction.config({"metaHandlers":ret}),ret}Object.defineProperty(exports,"__esModule",{"value":!0});var _class,_temp,_initialiseProps,_extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_regenerator=__webpack_require__(19),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=__webpack_require__(18),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_classCallCheck2=__webpack_require__(3),_classCallCheck3=_interopRequireDefault(_classCallCheck2);exports["default"]=creator;var _react=__webpack_require__(1),_edfMetaEngine=(_interopRequireDefault(_react),__webpack_require__(5)),_config=__webpack_require__(402),_config2=_interopRequireDefault(_config),_edfComponent=__webpack_require__(22),action=(_temp=_class=function action(option){(0,_classCallCheck3["default"])(this,action),_initialiseProps.call(this),this.metaAction=option.metaAction,this.config=_config2["default"].current,this.voucherAction=option.voucherAction,this.webapi=this.config.webapi},_initialiseProps=function _initialiseProps(){var _this=this;this.onInit=function(_ref){var component=_ref.component,injections=_ref.injections;_this.voucherAction.onInit({"component":component,"injections":injections}),_this.component=component,_this.injections=injections,_this.activeKey="",_this.component.props.setOkListener&&_this.component.props.setOkListener(_this.onOk);var archivesName=void 0;_this.component.props.archivesName&&(archivesName=_this.component.props.archivesName),injections.reduce("init",archivesName),_this.load()},this.load=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee(){var data,code,response,listResponse,obj;return _regenerator2["default"].wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return data={},code=void 0,response=void 0,_context.next=5,_this.webapi.basearchive.queryList();case 5:if(listResponse=_context.sent,!_this.component.props.activeKey){_context.next=11;break}return listResponse.list&&listResponse.list.forEach(function(data){data.name==_this.component.props.activeKey&&(_this.activeKey=data.id)}),_context.next=10,_this.webapi.basearchive.getCode({"userDefineArchiveId":_this.activeKey,"archiveName":"ba_userdefinearchive_data"});case 10:code=_context.sent;case 11:if(!_this.component.props.archivesName){_context.next=15;break}data.archivesName=!0,_context.next=26;break;case 15:if(void 0===_this.component.props.parentId){_context.next=22;break}return obj={"id":_this.component.props.parentId,"parentId":_this.component.props.id},_context.next=19,_this.webapi.basearchive.queryData(obj);case 19:response=_context.sent,_context.next=26;break;case 22:if(void 0===_this.component.props.id){_context.next=26;break}return _context.next=25,_this.webapi.basearchive.getCode({"userDefineArchiveId":_this.component.props.id,"archiveName":"ba_userdefinearchive_data"});case 25:code=_context.sent;case 26:code&&(data.code=code),response&&(data=response),_this.injections.reduce("load",data);case 29:case"end":return _context.stop()}},_callee,_this)})),this.onOk=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee2(){return _regenerator2["default"].wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,_this.save();case 2:return _context2.abrupt("return",_context2.sent);case 3:case"end":return _context2.stop()}},_callee2,_this)})),this.save=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee3(){var form,option,ts,archiveId,archivesName,checkedArr,ok,response;return _regenerator2["default"].wrap(function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return form=_this.metaAction.gf("data.form").toJS(),option={},ts=_this.metaAction.gf("data.ts"),archiveId=_this.metaAction.gf("data.archiveId"),archivesName=_this.component.props.archivesName,checkedArr=[{"path":"data.form.name","value":form.name}],archivesName||checkedArr.push({"path":"data.form.code","value":form.code}),_context3.next=5,_this.voucherAction.check(checkedArr,_this.check);case 5:if(ok=_context3.sent){_context3.next=9;break}return _this.metaAction.toast("warning","\u8bf7\u6309\u9875\u9762\u63d0\u793a\u4fe1\u606f\u4fee\u6539\u4fe1\u606f\u540e\u624d\u53ef\u63d0\u4ea4"),_context3.abrupt("return",!1);case 9:if(response=void 0,form.code=form.code?form.code.trim():"",form.name=form.name?form.name.trim():"",form.remark=form.remark?form.remark.trim():"",form.isReturnValue=!0,!archivesName){_context3.next=23;break}return option.name=form.name.trim(),option.isEnable=!0,option.isReturnValue=!0,_context3.next=20,_this.webapi.basearchive.queryName(option);case 20:response=_context3.sent,_context3.next=44;break;case 23:if(!_this.component.props.parentId){_context3.next=32;break}return form.id=_this.component.props.parentId,form.archiveId=archiveId,form.ts=ts,_context3.next=29,_this.webapi.basearchive.update(form);case 29:response=_context3.sent,_context3.next=44;break;case 32:if(!_this.component.props.id){_context3.next=39;break}return form.archiveId=_this.component.props.id,_context3.next=36,_this.webapi.basearchive.create(form);case 36:response=_context3.sent,_context3.next=44;break;case 39:if(""==_this.activeKey){_context3.next=44;break}return form.archiveId=_this.activeKey,_context3.next=43,_this.webapi.basearchive.create(form);case 43:response=_context3.sent;case 44:if(!response||!response.error){_context3.next=49;break}return _this.metaAction.toast("error",response.error.message),_context3.abrupt("return",!1);case 49:return _this.metaAction.toast("success","\u4fdd\u5b58\u6210\u529f"),_context3.abrupt("return",response);case 51:case"end":return _context3.stop()}},_callee3,_this)})),this.changeCheck=function(num){var form=_this.metaAction.gf("data.form").toJS();1==num?_this.voucherAction.check([{"path":"data.form.code","value":form.code}],_this.check):_this.voucherAction.check([{"path":"data.form.name","value":form.name}],_this.check)},this.check=function(option){if(option&&option.path)return"data.form.code"==option.path?{"errorPath":"data.other.error.code","message":option.value&&option.value.trim()?"":"\u8bf7\u5f55\u5165\u7f16\u7801"}:"data.form.name"==option.path?{"errorPath":"data.other.error.name","message":option.value&&option.value.trim()?"":"\u8bf7\u5f55\u5165\u540d\u79f0"}:void 0},this.fieldChange=function(path,value){_this.voucherAction.fieldChange(path,value,_this.check)}},_temp);module.exports=exports["default"]},"1644":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{"value":!0}),exports["default"]=void 0;var _dec,_class,_extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_classCallCheck2=__webpack_require__(3),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_possibleConstructorReturn2=__webpack_require__(7),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(6),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(1),_edfMetaEngine=(_interopRequireDefault(_react),__webpack_require__(5)),_index=__webpack_require__(681),_index2=_interopRequireDefault(_index),C=(_dec=(0,_edfMetaEngine.wrapper)(_index2["default"]),_dec(_class=function(_Component){function C(){return(0,_classCallCheck3["default"])(this,C),(0,_possibleConstructorReturn3["default"])(this,_Component.apply(this,arguments))}return(0,_inherits3["default"])(C,_Component),C.prototype.render=function render(){return this.props.monkeyKing((0,_extends3["default"])({},this.props,{"path":"root"}))},C}(_react.Component))||_class);exports["default"]=C,module.exports=exports["default"]},"1645":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function creator(option){var metaReducer=new _edfMetaEngine.reducer(option),o=new reducer((0,_extends3["default"])({},option,{"metaReducer":metaReducer}));return(0,_extends3["default"])({},metaReducer,o)}Object.defineProperty(exports,"__esModule",{"value":!0});var _class,_temp,_initialiseProps,_extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_keys=__webpack_require__(41),_keys2=_interopRequireDefault(_keys),_classCallCheck2=__webpack_require__(3),_classCallCheck3=_interopRequireDefault(_classCallCheck2);exports["default"]=creator;var _immutable=__webpack_require__(11),_edfMetaEngine=__webpack_require__(5),_config=__webpack_require__(402),_config2=_interopRequireDefault(_config),_data=__webpack_require__(680),reducer=(_temp=_class=function reducer(option){(0,_classCallCheck3["default"])(this,reducer),_initialiseProps.call(this),this.metaReducer=option.metaReducer,this.config=_config2["default"].current},_initialiseProps=function _initialiseProps(){var _this=this;this.init=function(state,option){var initState=(0,_data.getInitState)();return void 0!=option&&(initState.data.archivesName=option),_this.metaReducer.init(state,initState)},this.load=function(state,option){return option.code&&(state=_this.metaReducer.sf(state,"data.form.code",(0,_immutable.fromJS)(option.code))),option.name&&(state=_this.metaReducer.sf(state,"data.form.name",(0,_immutable.fromJS)(option.name))),option.remark&&(state=_this.metaReducer.sf(state,"data.form.remark",(0,_immutable.fromJS)(option.remark))),state=_this.metaReducer.sf(state,"data.form.isEnable",(0,_immutable.fromJS)(option.isEnable)),option.archivesName&&(state=_this.metaReducer.sf(state,"data.archivesName",(0,_immutable.fromJS)(!0))),option.archiveId&&(state=_this.metaReducer.sf(state,"data.archiveId",(0,_immutable.fromJS)(option.archiveId))),option.ts&&(state=_this.metaReducer.sf(state,"data.ts",(0,_immutable.fromJS)(option.ts))),1==(0,_keys2["default"])(option).length&&(state=_this.metaReducer.sf(state,"data.form.isEnable",(0,_immutable.fromJS)(!0))),state},this.modifyContent=function(state){var content=_this.metaReducer.gf(state,"data.content");return _this.metaReducer.sf(state,"data.content",content+"!")}},_temp);module.exports=exports["default"]},"1646":function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{"value":!0});var _edfUtils=__webpack_require__(12);exports["default"]={"basearchive":{"getCode":function getCode(option){return _edfUtils.fetch.post("/v1/ba/userdefinearchive/getAutoCode",option)},"queryName":function queryName(option){return _edfUtils.fetch.post("/v1/ba/userdefinearchive/create",option)},"create":function create(option){return _edfUtils.fetch.post("/v1/ba/userdefinearchive/createData",option)},"update":function update(option){return _edfUtils.fetch.post("/v1/ba/userdefinearchive/updateData",option)},"queryData":function queryData(option){return _edfUtils.fetch.post("/v1/ba/userdefinearchive/queryData",option)},"queryList":function queryList(option){return _edfUtils.fetch.post("v1/ba/userdefinearchive/queryList",option)}}},module.exports=exports["default"]}});