webpackJsonp([15,58],{"422":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function config(options){options&&(0,_extends3["default"])(_options,options)}Object.defineProperty(exports,"__esModule",{"value":!0});var _extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_webapi=__webpack_require__(1721),_webapi2=_interopRequireDefault(_webapi),_options={"webapi":_webapi2["default"]};config.current=_options,exports["default"]=config,module.exports=exports["default"]},"718":function(module,exports){"use strict";function getMeta(){return{"name":"root","component":"Layout","className":"ttk-edf-app-hotloader","children":[{"name":"left","component":"Layout","className":"ttk-edf-app-hotloader-left","children":[{"name":"search","component":"Input.Search","placeholder":"\u8bf7\u8f93\u5165app name\u8fc7\u6ee4","value":"{{data.search}}","onChange":"{{$searchChange}}"},{"name":"apps","component":"Tree","onSelect":"{{$appSelected}}","selectedKeys":"{{[data.selectApp.name]}}","_visible":"{{data.apps && data.apps.length > 0}}","children":[{"name":"app","component":"Tree.TreeNode","key":"{{data.apps[_rowIndex].name}}","title":"{{data.apps[_rowIndex].name}}","_power":"for in data.apps"}]}]},{"name":"content","component":"Layout","className":"ttk-edf-app-hotloader-content","children":[{"name":"card","component":"Card","className":"ttk-edf-app-hotloader-content-main","title":{"name":"type","component":"Radio.Group","value":"{{data.selectType}}","onChange":"{{$typeChange}}","children":[{"name":"meta","component":"Radio.Button","value":"meta","children":"\u5143\u6570\u636e(meta)"},{"name":"state","component":"Radio.Button","value":"state","children":"\u5f53\u524d\u72b6\u6001(state)"}]},"extra":{"name":"extra","component":"div","children":[{"name":"format","component":"Button","style":{"marginRight":6},"type":"primary","children":"\u683c\u5f0f\u5316","onClick":"{{$formatJson}}"},{"name":"reset","component":"Button","_visible":"{{data.selectType == 'meta'}}","type":"ghost","children":"\u91cd\u7f6e","onClick":"{{$reset}}"}]},"children":[{"name":"json","component":"CodeMirror","value":"{{data.currentJson}}","onChange":"{{$jsonChange}}","options":{"mode":"javascript","theme":"material","lineNumbers":!0,"inputStyle":"textarea"}}]}]}]}}function getInitState(){return{"data":{"apps":[],"selectApp":{},"search":"","other":{}}}}Object.defineProperty(exports,"__esModule",{"value":!0}),exports.getMeta=getMeta,exports.getInitState=getInitState},"1717":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function creator(option){var metaAction=new _edfMetaEngine.action(option),o=new action((0,_extends3["default"])({},option,{"metaAction":metaAction})),ret=(0,_extends3["default"])({},metaAction,o);return metaAction.config({"metaHandlers":ret}),ret}Object.defineProperty(exports,"__esModule",{"value":!0});var _extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_stringify=__webpack_require__(76),_stringify2=_interopRequireDefault(_stringify),_keys=__webpack_require__(41),_keys2=_interopRequireDefault(_keys),_classCallCheck2=__webpack_require__(3),_classCallCheck3=_interopRequireDefault(_classCallCheck2);exports["default"]=creator;var _react=__webpack_require__(1),_edfMetaEngine=(_interopRequireDefault(_react),__webpack_require__(5)),_config=__webpack_require__(422),_config2=_interopRequireDefault(_config),_edfUtils=__webpack_require__(12),_edfUtils2=_interopRequireDefault(_edfUtils),_common=__webpack_require__(1718),_immutable=(_interopRequireDefault(_common),__webpack_require__(11)),action=function action(option){var _this=this;(0,_classCallCheck3["default"])(this,action),this.onInit=function(_ref){var component=_ref.component,injections=_ref.injections;_this.component=component,_this.injections=injections,injections.reduce("init",{"apps":_this.getApps()})},this.getApps=function(search){var apps=_this.config.apps,keys=(0,_keys2["default"])(apps),ret=[];return keys.forEach(function(k){"config"!=k&&ret.push({"name":apps[k].name,"meta":apps[k].meta})}),search?ret.filter(function(o){return o.name.indexOf(search)!=-1}):ret},this.appSelected=function(selectedKeys){if(selectedKeys||0!=selectedKeys.length){var apps=_this.metaAction.gf("data.apps"),hit=apps.find(function(o){return o.get("name")==selectedKeys[0]});hit&&_this.metaAction.sfs({"data.selectApp":hit,"data.currentJson":"meta"==_this.metaAction.gf("data.selectType")?_edfUtils.beautify.beautifyJS((0,_stringify2["default"])(hit.get("meta").toJS())):_edfUtils.beautify.beautifyJS(_this.getAppState(hit.get("name")))})}},this.searchChange=function(e){_this.metaAction.sfs({"data.search":e.target.value,"data.apps":(0,_immutable.fromJS)(_this.getApps(e.target.value))})},this.typeChange=function(e){var currentJson="";if("meta"==e.target.value)currentJson=_edfUtils.beautify.beautifyJS((0,_stringify2["default"])(_this.metaAction.gf("data.selectApp.meta").toJS()));else{var appName=_this.metaAction.gf("data.selectApp.name");currentJson=_this.getAppState(appName)}_this.metaAction.sfs({"data.selectType":e.target.value,"data.currentJson":_edfUtils.beautify.beautifyJS(currentJson)})},this.getAppState=function(appName){var state=window.__mk_store__.getState().get(appName);return state?(state=state.toJS(),_edfUtils.beautify.beautifyJS((0,_stringify2["default"])({"data":state.data}))):"\u8be5\u5e94\u7528\u8fd8\u672a\u52a0\u8f7d"},this.jsonChange=function(e,d,v){try{var json=_edfUtils2["default"].string.toJson(v),appName=_this.metaAction.gf("data.selectApp.name"),type=_this.metaAction.gf("data.selectType");"meta"==type?_this.metaAction.sfs({"data.currentJson":v,"data.selectApp.meta":(0,_immutable.fromJS)(json)}):_this.metaAction.sf("data.currentJson",v),"meta"==type?_this.forceUpdateMeta(appName,json):"state"==type&&_this.forceUpdateState(appName,json)}catch(e){console.error(e)}},this.forceUpdateMeta=function(appName,meta){setTimeout(function(){_this.metaAction.setMetaForce(appName,meta);var apps=_this.metaAction.getAppInstances(),keys=(0,_keys2["default"])(apps);keys.forEach(function(k){if(apps[k].appName==appName){var inst=apps[k].instance;inst.forceUpdate()}})},0)},this.forceUpdateState=function(appName,state){setTimeout(function(){var apps=_this.metaAction.getAppInstances(),keys=(0,_keys2["default"])(apps);keys.forEach(function(k){if(apps[k].appName==appName){var inst=apps[k].instance;inst.props.setField("data",(0,_immutable.fromJS)(state.data))}})},0)},this.formatJson=function(){var formated=_edfUtils.beautify.beautifyJS(_this.metaAction.gf("data.currentJson"));_this.metaAction.sf("data.currentJson",formated)},this.reset=function(){var apps=_this.config.apps,keys=(0,_keys2["default"])(apps),selectApp=_this.metaAction.gf("data.selectApp");keys.forEach(function(k){apps[k].name==selectApp.get("name")&&(_this.metaAction.sfs({"data.selectApp.meta":(0,_immutable.fromJS)(apps[k].meta),"data.currentJson":_edfUtils.beautify.beautifyJS((0,_stringify2["default"])(apps[k].meta))}),_this.forceUpdateMeta(selectApp.get("name"),apps[k].meta))})},this.metaAction=option.metaAction,this.config=_config2["default"].current};module.exports=exports["default"]},"1718":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function addStyleSheet(str){(0,_less2["default"])().render(str,function(e,output){if(e)return void utils.exception.error(e);var s=document.querySelector("#edf-meta-design-dynamic-style");s&&s.remove();var head=document.head||document.getElementsByTagName("head")[0],style=document.createElement("style");style.id="edf-meta-design-dynamic-style",style.type="text/css",style.innerHTML=output.css,head.appendChild(style)})}Object.defineProperty(exports,"__esModule",{"value":!0}),exports.addStyleSheet=addStyleSheet;var _less=__webpack_require__(811),_less2=_interopRequireDefault(_less);exports["default"]={"addStyleSheet":addStyleSheet}},"1719":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{"value":!0}),exports["default"]=void 0;var _dec,_class,_extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_classCallCheck2=__webpack_require__(3),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_possibleConstructorReturn2=__webpack_require__(7),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(6),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(1),_edfMetaEngine=(_interopRequireDefault(_react),__webpack_require__(5)),_index=__webpack_require__(719),_index2=_interopRequireDefault(_index),C=(_dec=(0,_edfMetaEngine.wrapper)(_index2["default"]),_dec(_class=function(_Component){function C(){return(0,_classCallCheck3["default"])(this,C),(0,_possibleConstructorReturn3["default"])(this,_Component.apply(this,arguments))}return(0,_inherits3["default"])(C,_Component),C.prototype.render=function render(){return this.props.monkeyKing((0,_extends3["default"])({},this.props,{"path":"root"}))},C}(_react.Component))||_class);exports["default"]=C,module.exports=exports["default"]},"1720":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function creator(option){var metaReducer=new _edfMetaEngine.reducer(option),o=new reducer((0,_extends3["default"])({},option,{"metaReducer":metaReducer}));return(0,_extends3["default"])({},metaReducer,o)}Object.defineProperty(exports,"__esModule",{"value":!0});var _class,_temp,_initialiseProps,_extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_stringify=__webpack_require__(76),_stringify2=_interopRequireDefault(_stringify),_classCallCheck2=__webpack_require__(3),_classCallCheck3=_interopRequireDefault(_classCallCheck2);exports["default"]=creator;var _edfMetaEngine=(__webpack_require__(11),__webpack_require__(5)),_config=__webpack_require__(422),_config2=_interopRequireDefault(_config),_data=__webpack_require__(718),_edfUtils=__webpack_require__(12),reducer=(_temp=_class=function reducer(option){(0,_classCallCheck3["default"])(this,reducer),_initialiseProps.call(this),this.metaReducer=option.metaReducer,this.config=_config2["default"].current},_initialiseProps=function _initialiseProps(){var _this=this;this.init=function(state,option){var initState=(0,_data.getInitState)();return initState.data.apps=option.apps,option.apps.length>0&&(initState.data.selectApp=option.apps[0],initState.data.selectType="meta",initState.data.currentJson=_edfUtils.beautify.beautifyJS((0,_stringify2["default"])(option.apps[0].meta))),_this.metaReducer.init(state,initState)}},_temp);module.exports=exports["default"]},"1721":1790});