webpackJsonp([9,58],{"428":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function config(options){options&&(0,_extends3["default"])(_options,options)}Object.defineProperty(exports,"__esModule",{"value":!0});var _extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_webapi=__webpack_require__(1745),_webapi2=_interopRequireDefault(_webapi),_options={"webapi":_webapi2["default"]};config.current=_options,exports["default"]=config,module.exports=exports["default"]},"730":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function getMeta(){var _ref;return{"name":"root","component":"div","className":"ttk-edf-app-my-setting","children":{"name":"content","component":"div","className":"ttk-edf-app-my-setting-content","children":{"name":"item","component":"div","className":"container","children":[{"name":"baseInfo","component":"div","className":"ttk-edf-app-my-setting-baseInfo","children":[{"name":"title","component":"h1","className":"ttk-edf-app-my-setting-baseInfo-title","children":"\u4e2a\u4eba\u57fa\u7840\u4fe1\u606f"},{"name":"form","component":"Form","className":"ttk-edf-app-my-setting-baseInfo-form","children":[{"name":"photoItem","component":"Form.Item","className":"ttk-edf-app-my-setting-baseInfo-form-photo","required":!0,"children":[{"name":"container","component":"div","children":[{"name":"photo","component":"img","src":"{{$getPhoto(data.form.sex)}}"}]}]},{"name":"detailItem","component":"div","className":"ttk-edf-app-my-setting-baseInfo-form-detail","children":[{"name":"sexItem","component":"Form.Item","className":"ttk-edf-app-my-setting-baseInfo-form-detail-sex","label":"\u6027\u522b","required":!0,"children":[{"name":"male","component":"img","className":"{{data.form.sex == 1 ? 'selectImg' : 'unSelectImg'}}","src":'{{$getPhoto("1")}}',"onClick":'{{function(e){$setField("data.form.sex", "1")}}}'},{"name":"female","component":"img","className":"{{data.form.sex == 2 ? 'selectImg' : 'unSelectImg'}}","src":'{{$getPhoto("2")}}',"onClick":'{{function(e){$setField("data.form.sex", "2")}}}'},{"name":"other","component":"img","className":"{{data.form.sex == 0 ? 'selectImg' : 'unSelectImg'}}","src":'{{$getPhoto("0")}}',"onClick":'{{function(e){$setField("data.form.sex", "0")}}}'}]},{"name":"mobileItem","component":"Form.Item","label":"\u624b\u673a\u53f7","required":!0,"children":[{"name":"mobile","component":"Input","disabled":"disabled","value":"{{data.form.mobile}}"}]},{"name":"nicknameItem","component":"Form.Item","label":"\u6635\u79f0","required":!0,"validateStatus":"{{data.other.error.nickname?'error':'success'}}","help":"{{data.other.error.nickname}}","children":[{"name":"nickname","component":"Input","onChange":"{{function(e){$fieldChange('data.form.nickname', e.target.value)}}}","value":"{{data.form.nickname}}"}]}]},{"name":"saveItem","component":"Form.Item","className":"ttk-edf-app-my-setting-baseInfo-form-saveBtn","children":[{"name":"save","component":"Button","type":"primary","children":"\u4fdd\u5b58","onClick":"{{$saveBaseInfo}}"}]}]}]},{"name":"security","component":"div","className":"ttk-edf-app-my-setting-security","children":[{"name":"title","component":"h1","className":"ttk-edf-app-my-setting-baseInfo-title","style":{"marginTop":"12px"},"children":"\u5b89\u5168\u8bbe\u7f6e"},{"name":"item","component":"div","className":"ttk-edf-app-my-setting-security-box","children":[(_ref={"name":"grid","component":"div","className":"ttk-edf-app-my-setting-security-grid"},(0,_defineProperty3["default"])(_ref,"className","ttk-edf-app-my-setting-security-layout"),(0,_defineProperty3["default"])(_ref,"children",[{"name":"password","className":"ttk-edf-app-my-setting-security-grid-row","component":"div","key":"password","dataGrid":{"x":0,"y":0,"w":1,"h":1},"children":[{"name":"level","component":"div","children":[]},{"name":"type","component":"div","children":{"name":"p","component":"p","children":"\u767b\u5f55\u5bc6\u7801"}},{"name":"remind","component":"div","children":[{"name":"p","component":"div","className":"pws","children":[{"name":"item1","component":"span","className":"pws-title","children":"\u5bc6\u7801\u5f3a\u5ea6"},{"name":"text","component":"span","className":"pws-level","children":"{{$getPasswordStrength()}}"},{"name":"bar","component":"div","className":"pws-bar","children":{"name":"bar","component":"Progress","className":"{{$getColor()}}","style":{"display":"none"},"percent":"{{data.form.securityLevel*20}}","showInfo":!1}}]},{"name":"p","component":"p","children":"\u5efa\u8bae\u60a8\u8bbe\u7f6e\u4e3a8\u4e2a\u5b57\u7b26\u4ee5\u4e0a\uff0c\u5305\u542b\u6570\u5b57\u3001\u5927\u5c0f\u5199\u5b57\u6bcd\u3001\u7279\u6b8a\u5b57\u7b26\u7684\u5bc6\u7801"}]},{"name":"btn","component":"div","children":[{"name":"btn","component":"Button","onClick":"{{$changePassword}}","type":"primary","children":"\u4fee\u6539"}]}]},{"name":"phone","className":"ttk-edf-app-my-setting-security-grid-row","component":"div","key":"phone","dataGrid":{"x":1,"y":0,"w":1,"h":1},"children":[{"name":"level","component":"div","children":[]},{"name":"type","component":"div","children":{"name":"p","component":"p","children":"\u624b\u673a\u7ed1\u5b9a"}},{"name":"remind","component":"div","children":{"name":"p","component":"p","children":'{{"\u60a8\u7ed1\u5b9a\u7684\u624b\u673a\u4e3a\uff1a" + data.form.mobile}}'}},{"name":"btn","component":"div","children":[{"name":"btn","component":"Button","type":"primary","onClick":"{{$changeMobile}}","children":'{{true ? "\u4fee\u6539" : "\u7ed1\u5b9a"}}'}]}]}]),_ref)]}]}]}}}}function getInitState(){return{"data":{"form":{"sex":"0"},"other":{"error":{}}}}}Object.defineProperty(exports,"__esModule",{"value":!0});var _defineProperty2=__webpack_require__(9),_defineProperty3=_interopRequireDefault(_defineProperty2);exports.getMeta=getMeta,exports.getInitState=getInitState},"1734":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function creator(option){var metaAction=new _edfMetaEngine.action(option),o=new action((0,_extends3["default"])({},option,{"metaAction":metaAction})),ret=(0,_extends3["default"])({},metaAction,o);return metaAction.config({"metaHandlers":ret}),ret}Object.defineProperty(exports,"__esModule",{"value":!0});var _extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_getIterator2=__webpack_require__(28),_getIterator3=_interopRequireDefault(_getIterator2),_regenerator=__webpack_require__(20),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=__webpack_require__(19),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_classCallCheck2=__webpack_require__(3),_classCallCheck3=_interopRequireDefault(_classCallCheck2);exports["default"]=creator;var _react=__webpack_require__(1),_edfMetaEngine=(_interopRequireDefault(_react),__webpack_require__(5)),_config=__webpack_require__(428),_config2=_interopRequireDefault(_config),_female=__webpack_require__(2377),_female2=_interopRequireDefault(_female),_male=__webpack_require__(2378),_male2=_interopRequireDefault(_male),_other=__webpack_require__(2379),_other2=_interopRequireDefault(_other),_edfUtils=__webpack_require__(12),action=function action(option){var _this=this;(0,_classCallCheck3["default"])(this,action),this.onInit=function(_ref){var component=_ref.component,injections=_ref.injections;_this.component=component,_this.injections=injections,injections.reduce("init"),_this.load()},this.load=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee(){var currentUser,response;return _regenerator2["default"].wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return currentUser=_this.metaAction.context.get("currentUser"),_context.next=3,_this.webapi.mySetting.init(currentUser&&currentUser.id);case 3:response=_context.sent,_this.injections.reduce("load",response);case 5:case"end":return _context.stop()}},_callee,_this)})),this.saveBaseInfo=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee2(){var form,ok;return _regenerator2["default"].wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return form=_this.metaAction.gf("data.form").toJS(),_context2.next=3,_this.check([{"path":"data.form.nickname","value":form.nickname}]);case 3:if(ok=_context2.sent){_context2.next=6;break}return _context2.abrupt("return");case 6:return _context2.next=8,_this.webapi.user.update({"mobile":form.mobile,"sex":form.sex,"nickname":form.nickname,"birthday":form.birthday});case 8:_this.component.props.onPortalReload&&_this.component.props.onPortalReload(),_this.metaAction.toast("success","\u4fdd\u5b58\u4e2a\u4eba\u8d44\u6599\u6210\u529f");case 10:case"end":return _context2.stop()}},_callee2,_this)})),this.upload=function(){},this.getPhoto=function(sex){return 1==sex?_male2["default"]:2==sex?_female2["default"]:_other2["default"]},this.getPasswordStrength=function(){var level=_this.metaAction.gf("data.form.passwordStrength");return 1==level?"\u5f31":2==level?"\u4e2d":3==level?"\u9ad8":void 0},this.getColor=function(){var level=_this.metaAction.gf("data.form.passwordStrength");return 1==level?"orangeBg":2==level?"yellowBg":3==level?"greenBg":void 0},this.fieldChange=function(){var _ref4=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee3(fieldPath,value){return _regenerator2["default"].wrap(function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,_this.check([{"path":fieldPath,"value":value}]);case 2:case"end":return _context3.stop()}},_callee3,_this)}));return function(_x,_x2){return _ref4.apply(this,arguments)}}(),this.check=function(){var _ref5=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee4(fieldPathAndValues){var checkResults,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,o,r,json,hasError;return _regenerator2["default"].wrap(function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(fieldPathAndValues){_context4.next=2;break}return _context4.abrupt("return");case 2:checkResults=[],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0,_context4.prev=6,_iterator=(0,_getIterator3["default"])(fieldPathAndValues);case 8:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context4.next=22;break}if(o=_step.value,r=(0,_extends3["default"])({},o),"data.form.nickname"!=o.path){_context4.next=18;break}return _context4.t0=_extends3["default"],_context4.t1=r,_context4.next=16,_this.checkNickname(o.value);case 16:_context4.t2=_context4.sent,(0,_context4.t0)(_context4.t1,_context4.t2);case 18:checkResults.push(r);case 19:_iteratorNormalCompletion=!0,_context4.next=8;break;case 22:_context4.next=28;break;case 24:_context4.prev=24,_context4.t3=_context4["catch"](6),_didIteratorError=!0,_iteratorError=_context4.t3;case 28:_context4.prev=28,_context4.prev=29,!_iteratorNormalCompletion&&_iterator["return"]&&_iterator["return"]();case 31:if(_context4.prev=31,!_didIteratorError){_context4.next=34;break}throw _iteratorError;case 34:return _context4.finish(31);case 35:return _context4.finish(28);case 36:return json={},hasError=!0,checkResults.forEach(function(o){json[o.path]=o.value,json[o.errorPath]=o.message,o.message&&(hasError=!1)}),_this.metaAction.sfs(json),_context4.abrupt("return",hasError);case 41:case"end":return _context4.stop()}},_callee4,_this,[[6,24,28,36],[29,,31,35]])}));return function(_x3){return _ref5.apply(this,arguments)}}(),this.checkNickname=function(){var _ref6=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee5(nickname){var message;return _regenerator2["default"].wrap(function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return nickname?nickname.length>50&&(message="\u6635\u79f0\u4e0d\u80fd\u8d85\u8fc750\u4e2a\u5b57"):message="\u8bf7\u5f55\u5165\u6635\u79f0",_context5.abrupt("return",{"errorPath":"data.other.error.nickname","message":message});case 2:case"end":return _context5.stop()}},_callee5,_this)}));return function(_x4){return _ref6.apply(this,arguments)}}(),this.getAccessTokenJson=function(){return{"token":_edfUtils.fetch.getAccessToken()}},this.changePassword=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee6(){var ret;return _regenerator2["default"].wrap(function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,_this.metaAction.modal("show",{"title":"\u4fee\u6539\u767b\u5f55\u5bc6\u7801","width":500,"height":251,"children":_this.metaAction.loadApp("ttk-edf-app-my-setting-change-password",{"store":_this.component.props.store})});case 2:ret=_context6.sent,ret.passwordStrength&&_this.metaAction.sf("data.form.passwordStrength",ret.passwordStrength);case 4:case"end":return _context6.stop()}},_callee6,_this)})),this.changeMobile=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee7(){var ret;return _regenerator2["default"].wrap(function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,_this.metaAction.modal("show",{"title":"\u4fee\u6539\u624b\u673a\u53f7","width":500,"height":251,"children":_this.metaAction.loadApp("ttk-edf-app-my-setting-change-mobile",{"store":_this.component.props.store,"mobile":_this.metaAction.gf("data.form.mobile")})});case 2:ret=_context7.sent,ret.newMobile&&_this.metaAction.sf("data.form.mobile",ret.newMobile);case 4:case"end":return _context7.stop()}},_callee7,_this)})),this.metaAction=option.metaAction,this.config=_config2["default"].current,this.webapi=this.config.webapi};module.exports=exports["default"]},"1743":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{"value":!0}),exports["default"]=void 0;var _dec,_class,_extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_classCallCheck2=__webpack_require__(3),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_possibleConstructorReturn2=__webpack_require__(7),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(6),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(1),_edfMetaEngine=(_interopRequireDefault(_react),__webpack_require__(5)),_index=__webpack_require__(731),_index2=_interopRequireDefault(_index),C=(_dec=(0,_edfMetaEngine.wrapper)(_index2["default"]),_dec(_class=function(_Component){function C(){return(0,_classCallCheck3["default"])(this,C),(0,_possibleConstructorReturn3["default"])(this,_Component.apply(this,arguments))}return(0,_inherits3["default"])(C,_Component),C.prototype.render=function render(){return this.props.monkeyKing((0,_extends3["default"])({},this.props,{"path":"root"}))},C}(_react.Component))||_class);exports["default"]=C,module.exports=exports["default"]},"1744":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function creator(option){var metaReducer=new _edfMetaEngine.reducer(option),o=new reducer((0,_extends3["default"])({},option,{"metaReducer":metaReducer}));return(0,_extends3["default"])({},metaReducer,o)}Object.defineProperty(exports,"__esModule",{"value":!0});var _extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_classCallCheck2=__webpack_require__(3),_classCallCheck3=_interopRequireDefault(_classCallCheck2);exports["default"]=creator;var _immutable=__webpack_require__(11),_edfMetaEngine=__webpack_require__(5),_config=__webpack_require__(428),_config2=_interopRequireDefault(_config),_data=__webpack_require__(730),reducer=function reducer(option){var _this=this;(0,_classCallCheck3["default"])(this,reducer),this.init=function(state,option){var initState=(0,_data.getInitState)();return _this.metaReducer.init(state,initState)},this.load=function(state,_ref){var user=_ref.user,securityLevel=_ref.securityLevel;return user.sex=void 0===user.sex?0:user.sex,user.sex=user.sex+"",user.nickname=user.nickname||user.mobile,_this.metaReducer.sf(state,"data.form",(0,_immutable.fromJS)((0,_extends3["default"])({},user,{"securityLevel":securityLevel})))},this.metaReducer=option.metaReducer,this.config=_config2["default"].current};module.exports=exports["default"]},"1745":function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{"value":!0});var _edfUtils=__webpack_require__(12);exports["default"]={"mySetting":{"init":function init(userId){return _edfUtils.fetch.post("/v1/edf/mySetting/init",userId)}},"user":{"update":function update(option){return _edfUtils.fetch.post("/v1/edf/user/update",option)}}},module.exports=exports["default"]},"2377":function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"a5f9c9e02d9e11ec0abecda5743b25e1.png"},"2378":function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"08af014be0c442afefdc69224aba6418.png"},"2379":function(module,exports,__webpack_require__){module.exports=__webpack_require__.p+"c290fc8d67025714dc4899c876550d35.png"}});