webpackJsonp([29,60],{"433":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function config(options){options&&(0,_extends3["default"])(_options,options)}Object.defineProperty(exports,"__esModule",{"value":!0});var _extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_webapi=__webpack_require__(1772),_webapi2=_interopRequireDefault(_webapi),_options={"webapi":_webapi2["default"]};config.current=_options,exports["default"]=config,module.exports=exports["default"]},"742":function(module,exports){"use strict";function getMeta(){return{"name":"root","component":"Layout","className":"ttk-edf-app-portal-menu","children":[{"name":"left","component":"Card","className":"ttk-edf-app-portal-menu-left","title":"\u83dc\u5355","extra":{"name":"header","component":"div","children":[{"name":"add","component":"Button","className":"button","icon":"plus","onClick":"{{$addType}}"},{"name":"modify","component":"Button","className":"button","icon":"edit","onClick":"{{$modifyType}}"},{"name":"del","component":"Button","icon":"close","onClick":"{{$delType}}"}]},"children":[{"name":"tree","component":"Tree","selectedKeys":"{{[data.filter.parentId+'']}}","onSelect":"{{$selectType}}","children":"{{$loopTreeChildren(data.other.tree)}}"}]},{"name":"content","component":"Card","className":"ttk-edf-app-portal-menu-content","title":"\u83dc\u5355","extra":{"name":"header","component":"div","className":"ttk-edf-app-portal-menu-content-header","children":[{"name":"add","component":"Button","className":"button","type":"primary","children":"\u65b0\u589e","onClick":"{{$addDetail}}"},{"name":"del","component":"Button","className":"button","children":"\u5220\u9664","onClick":"{{$batchDelDetail}}"},{"name":"setting","component":"Button","children":"\u680f\u76ee\u8bbe\u7f6e","onClick":"{{$columnSetting}}"}]},"children":[{"name":"dataGrid","component":"DataGrid","className":"","headerHeight":37,"rowHeight":35,"enableSequence":!0,"startSequence":"{{(data.pagination.currentPage-1)*data.pagination.pageSize + 1}}","rowsCount":"{{$getListRowsCount()}}","columns":"{{$getListColumns()}}"},{"name":"footer","className":"ttk-edf-app-portal-menu-content-footer","component":"div","children":[{"name":"pagination","component":"Pagination","showSizeChanger":!0,"pageSize":"{{data.pagination.pageSize}}","current":"{{data.pagination.currentPage}}","total":"{{data.pagination.totalCount}}","onChange":"{{$pageChanged}}","onShowSizeChange":"{{$pageChanged}}"}]}]}]}}function getInitState(){return{"data":{"columns":[],"list":[],"pagination":{"currentPage":1,"totalPage":0,"totalData":0,"pageSize":50},"filter":{"type":1},"other":{}}}}Object.defineProperty(exports,"__esModule",{"value":!0}),exports.getMeta=getMeta,exports.getInitState=getInitState},"1769":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function creator(option){var metaAction=new _edfMetaEngine.action(option),o=new action((0,_extends3["default"])({},option,{"metaAction":metaAction})),ret=(0,_extends3["default"])({},metaAction,o);return metaAction.config({"metaHandlers":ret}),ret}Object.defineProperty(exports,"__esModule",{"value":!0});var _extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_regenerator=__webpack_require__(19),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=__webpack_require__(18),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_classCallCheck2=__webpack_require__(3),_classCallCheck3=_interopRequireDefault(_classCallCheck2);exports["default"]=creator;var _react=__webpack_require__(1),_react2=_interopRequireDefault(_react),_edfMetaEngine=__webpack_require__(5),_config=(__webpack_require__(11),__webpack_require__(433)),_config2=_interopRequireDefault(_config),_moment=__webpack_require__(14),_edfComponent=(_interopRequireDefault(_moment),__webpack_require__(22)),action=function action(option){var _this=this;(0,_classCallCheck3["default"])(this,action),this.onInit=function(_ref){var component=_ref.component,injections=_ref.injections;_this.component=component,_this.injections=injections,injections.reduce("init");var pagination=_this.metaAction.gf("data.pagination").toJS();_this.load(pagination)},this.load=function(){var _ref2=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee(page){var response,columns,entity=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _regenerator2["default"].wrap(function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return page.orderBy="code",_context.next=3,_this.webapi.menu.queryPageList({"page":page,"entity":entity});case 3:return response=_context.sent,_context.next=6,_this.webapi.columnDetail.findByColumnCode("menuList");case 6:columns=_context.sent,response.columns=columns,response.filter=entity,_this.injections.reduce("load",response);case 10:case"end":return _context.stop()}},_callee,_this)}));return function(_x){return _ref2.apply(this,arguments)}}(),this.reload=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee2(){var pagination,filter;return _regenerator2["default"].wrap(function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:pagination=_this.metaAction.gf("data.pagination").toJS(),filter=_this.metaAction.gf("data.filter").toJS(),_this.load(pagination,filter);case 3:case"end":return _context2.stop()}},_callee2,_this)})),this.getListRowsCount=function(){return _this.metaAction.gf("data.list").size},this.getListColumns=function(){var menus=_this.metaAction.gf("data.list").toJS(),columns=_this.metaAction.gf("data.columns").toJS(),Column=_edfComponent.DataGrid.Column,Cell=_edfComponent.DataGrid.Cell,cols=[_react2["default"].createElement(Column,{"name":"select","columnKey":"select","flexGrow":1,"width":40,"header":_react2["default"].createElement(Cell,{"name":"cb"},_react2["default"].createElement(_edfComponent.Checkbox,{"checked":_this.isSelectAll(),"onChange":_this.selectAll()})),"cell":function cell(ps){return _react2["default"].createElement(Cell,{"name":"cell"},_react2["default"].createElement(_edfComponent.Checkbox,{"onChange":_this.selectRow(ps.rowIndex),"checked":menus[ps.rowIndex].selected}))}})];return columns.forEach(function(op){if(1==op.isVisible){var col=_react2["default"].createElement(Column,{"name":op.id,"columnKey":op.id,"flexGrow":1,"width":op.width,"header":_react2["default"].createElement(Cell,{"name":"header"},op.caption),"cell":function cell(ps){return"code"==op.fieldName?_react2["default"].createElement(Cell,null,_react2["default"].createElement("a",{"onClick":_this.modifyDetail(menus[ps.rowIndex].id)},menus[ps.rowIndex][op.fieldName])):_react2["default"].createElement(Cell,null,menus[ps.rowIndex][op.fieldName])}});cols.push(col)}}),cols},this.isSelectAll=function(){var list=_this.metaAction.gf("data.list");if(!list||0==list.size)return!1;var data=list.every(function(o){return o.get("selected")});return data},this.selectAll=function(){return function(e){_this.injections.reduce("selectAll",e.target.checked)}},this.selectRow=function(rowIndex){return function(e){_this.injections.reduce("selectRow",rowIndex,e.target.checked)}},this.pageChanged=function(currentPage,pageSize){var filter=_this.metaAction.gf("data.filter").toJS();_this.load({"currentPage":currentPage,"pageSize":pageSize},filter)},this.selectType=function(selectedKeys,info){var parentId=selectedKeys[0]||0,pagination={"currentPage":1,"totalData":0,"pageSize":50},filter={"parentId":Number(parentId),"isReloadTree":!1};return 0!=info.selected&&void _this.load(pagination,filter)},this.loopTreeChildren=function(data,id){return data?data.map(function(item){return item.children&&item.children.length?_react2["default"].createElement(_edfComponent.Tree.TreeNode,{"key":item.id,"title":item.name},_this.loopTreeChildren(item.children)):_react2["default"].createElement(_edfComponent.Tree.TreeNode,{"key":item.id,"title":item.name})}):null},this.addType=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee3(){var parent,ret,pagination;return _regenerator2["default"].wrap(function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return parent=_this.metaAction.gf("data.filter.parentId")||0,_context3.next=3,_this.metaAction.modal("show",{"title":"\u65b0\u589e","children":_this.metaAction.loadApp("ttk-edf-app-portal-menu-detail",{"store":_this.component.props.store,"parentId":parent})});case 3:ret=_context3.sent,ret&&(pagination=_this.metaAction.gf("data.pagination").toJS(),_this.load(pagination));case 5:case"end":return _context3.stop()}},_callee3,_this)})),this.modifyType=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee4(){var id,ret,pagination;return _regenerator2["default"].wrap(function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(id=_this.metaAction.gf("data.filter.parentId")){_context4.next=4;break}return _this.metaAction.toast("error","\u8bf7\u9009\u4e2d\u4fee\u6539\u9879"),_context4.abrupt("return");case 4:return _context4.next=6,_this.metaAction.modal("show",{"title":"\u4fee\u6539","children":_this.metaAction.loadApp("ttk-edf-app-portal-menu-detail",{"store":_this.component.props.store,"id":id})});case 6:ret=_context4.sent,ret&&(pagination=_this.metaAction.gf("data.pagination").toJS(),_this.load(pagination));case 8:case"end":return _context4.stop()}},_callee4,_this)})),this.delType=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee5(){var parentId,ret,id,response,pagination;return _regenerator2["default"].wrap(function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(parentId=_this.metaAction.gf("data.filter.parentId")){_context5.next=4;break}return _this.metaAction.toast("error","\u8bf7\u9009\u4e2d\u5220\u9664\u9879"),_context5.abrupt("return");case 4:return _context5.next=6,_this.metaAction.modal("confirm",{"title":"\u5220\u9664","content":"\u786e\u8ba4\u5220\u9664?"});case 6:if(ret=_context5.sent,!ret){_context5.next=15;break}return id=_this.metaAction.gf("data.filter.parentId"),_context5.next=11,_this.webapi.menu.deleteBatch([{"id":id}]);case 11:response=_context5.sent,_this.metaAction.toast("success","\u5220\u9664\u6210\u529f"),pagination=_this.metaAction.gf("data.pagination").toJS(),_this.load(pagination);case 15:case"end":return _context5.stop()}},_callee5,_this)})),this.addDetail=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee6(){var parent,ret;return _regenerator2["default"].wrap(function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return parent=_this.metaAction.gf("data.filter.parentId")||0,_context6.next=3,_this.metaAction.modal("show",{"title":"\u65b0\u589e","width":500,"children":_this.metaAction.loadApp("ttk-edf-app-portal-menu-detail",{"store":_this.component.props.store,"parentId":parent})});case 3:ret=_context6.sent,ret&&_this.reload();case 5:case"end":return _context6.stop()}},_callee6,_this)})),this.modifyDetail=function(id){return(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee7(){var ret;return _regenerator2["default"].wrap(function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,_this.metaAction.modal("show",{"title":"\u4fee\u6539","children":_this.metaAction.loadApp("ttk-edf-app-portal-menu-detail",{"store":_this.component.props.store,"id":id})});case 2:ret=_context7.sent,ret&&_this.reload();case 4:case"end":return _context7.stop()}},_callee7,_this)}))},this.batchDelDetail=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee8(){var lst,selectRows,ret,ids;return _regenerator2["default"].wrap(function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return lst=_this.metaAction.gf("data.list"),lst&&0!=lst.size||_this.metaAction.toast("error","\u8bf7\u9009\u4e2d\u5220\u9664\u9879"),selectRows=lst.filter(function(o){return o.get("selected")}),selectRows&&0!=selectRows.size||_this.metaAction.toast("error","\u8bf7\u9009\u4e2d\u5220\u9664\u9879"),_context8.next=6,_this.metaAction.modal("confirm",{"title":"\u5220\u9664","content":"\u786e\u8ba4\u5220\u9664?"});case 6:if(ret=_context8.sent){_context8.next=9;break}return _context8.abrupt("return");case 9:return ids=selectRows.map(function(o){return{"id":o.get("id")}}).toJS(),_context8.next=12,_this.webapi.menu.deleteBatch(ids);case 12:_this.metaAction.toast("success","\u5220\u9664\u6210\u529f"),_this.reload();case 14:case"end":return _context8.stop()}},_callee8,_this)})),this.columnSetting=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function _callee9(){var ret;return _regenerator2["default"].wrap(function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,_this.metaAction.modal("show",{"title":"\u680f\u76ee\u8bbe\u7f6e","children":_this.metaAction.loadApp("ttk-edf-app-column-setting",{"store":_this.component.props.store,"columnCode":"menuList"})});case 2:ret=_context9.sent,ret&&_this.reload();case 4:case"end":return _context9.stop()}},_callee9,_this)})),this.metaAction=option.metaAction,this.config=_config2["default"].current,this.webapi=this.config.webapi};module.exports=exports["default"]},"1770":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}Object.defineProperty(exports,"__esModule",{"value":!0}),exports["default"]=void 0;var _dec,_class,_extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_classCallCheck2=__webpack_require__(3),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_possibleConstructorReturn2=__webpack_require__(7),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(6),_inherits3=_interopRequireDefault(_inherits2),_react=__webpack_require__(1),_edfMetaEngine=(_interopRequireDefault(_react),__webpack_require__(5)),_index=__webpack_require__(743),_index2=_interopRequireDefault(_index),C=(_dec=(0,_edfMetaEngine.wrapper)(_index2["default"]),_dec(_class=function(_Component){function C(){return(0,_classCallCheck3["default"])(this,C),(0,_possibleConstructorReturn3["default"])(this,_Component.apply(this,arguments))}return(0,_inherits3["default"])(C,_Component),C.prototype.render=function render(){return this.props.monkeyKing((0,_extends3["default"])({},this.props,{"path":"root"}))},C}(_react.Component))||_class);exports["default"]=C,module.exports=exports["default"]},"1771":function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function creator(option){var metaReducer=new _edfMetaEngine.reducer(option),o=new reducer((0,_extends3["default"])({},option,{"metaReducer":metaReducer}));return(0,_extends3["default"])({},metaReducer,o)}Object.defineProperty(exports,"__esModule",{"value":!0});var _extends2=__webpack_require__(2),_extends3=_interopRequireDefault(_extends2),_classCallCheck2=__webpack_require__(3),_classCallCheck3=_interopRequireDefault(_classCallCheck2);exports["default"]=creator;var _immutable=__webpack_require__(11),_edfUtils=__webpack_require__(12),_edfMetaEngine=__webpack_require__(5),_config=__webpack_require__(433),_data=(_interopRequireDefault(_config),__webpack_require__(742)),reducer=function reducer(option){var _this=this;(0,_classCallCheck3["default"])(this,reducer),this.init=function(state,option){return _this.metaReducer.init(state,(0,_data.getInitState)())},this.load=function(state,response){return state=_this.metaReducer.sf(state,"data.columns",(0,_immutable.fromJS)(response.columns)),state=_this.metaReducer.sf(state,"data.list",(0,_immutable.fromJS)(response.list)),state=_this.metaReducer.sf(state,"data.pagination",(0,_immutable.fromJS)(response.page)),state=_this.metaReducer.sf(state,"data.filter",(0,_immutable.fromJS)(response.filter)),void 0!==response.filter.isReloadTree&&response.filter.isReloadTree!==!0||(state=_this.metaReducer.sf(state,"data.other.tree",(0,_immutable.fromJS)(_edfUtils.tree.build(response.list).children))),state},this.selectAll=function(state,checked){var lst=_this.metaReducer.gf(state,"data.list");if(!lst||0==lst.size)return state;for(var i=0;i<lst.size;i++)state=_this.metaReducer.sf(state,"data.list."+i+".selected",checked);return state},this.selectRow=function(state,rowIndex,checked){return state=_this.metaReducer.sf(state,"data.list."+rowIndex+".selected",checked)},this.metaReducer=option.metaReducer};module.exports=exports["default"]},"1772":function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{"value":!0});var _edfUtils=__webpack_require__(12);exports["default"]={"menu":{"queryPageList":function queryPageList(option){return _edfUtils.fetch.post("/v1/edf/menu/queryPageList",option)},"deleteBatch":function deleteBatch(option){return _edfUtils.fetch.post("/v1/edf/menu/deleteBatch",option)}},"columnDetail":{"findByColumnCode":function findByColumnCode(code){return _edfUtils.fetch.post("/v1/edf/columnDetail/findByColumnCode",code)}}},module.exports=exports["default"]}});